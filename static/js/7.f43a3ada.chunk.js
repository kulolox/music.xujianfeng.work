(this.webpackJsonpk_music=this.webpackJsonpk_music||[]).push([[7],{215:function(e,a,t){"use strict";var n=t(9),r=t(0),c=t.n(r),i=t(216),l=t.n(i);a.a=function(e){var a=Object(r.useState)(!1),t=Object(n.a)(a,2),i=t[0],s=t[1];return Object(r.useEffect)((function(){var a=new Image;return a.src=e.src,a.onload=function(){s(!0)},a.onload=function(){}}),[e.src]),c.a.createElement("img",{src:i?e.src:l.a,style:{width:e.width,height:e.height,border:e.border?"1px solid #f1f1f1":"none"},alt:""})}},216:function(e,a,t){e.exports=t.p+"static/media/default_image.3590e8c0.svg"},273:function(e,a,t){e.exports={album:"_2hzivxDtZ7Lpvgv_X6pVe_",head:"_2G7dEGYEINlmoML5hs1NhP",logo:"_1XpWqywhwbUYPRNTj_2SwZ",img:"SjhxsrVLLEEskJ03LfpEl",main:"_1-lryxsU1rMvVjdxnaLMSB",name:"_1TgPIWbSRfEXB5K_PytIj-",creater:"_3ybRWFtnK1mBmZh1uYR2gJ",nickname:"_1jILlatWTSWRHiqXAiGlp6",createTime:"_1i2DNrQyAagf55L_oxgMSm",buttonGroup:"_2oNF_eCmWK3wXiMEX8ipq8",tags:"_2NXyU-l3NDvjYBWcqg7rAo",listBox:"_380ztTIKx73V2U9a6z6OTk",title:"_2R7Lx1geUI8ZuUW1MaR26i",list:"i7c1ccAuZx-PWGrwXZvan",item:"_1UK-h9FidD_9NTxhMCLDzD",index:"_3FrKiNJzzQaolrCA5-D_lD",song:"_1Mdfhs18QHPInAh85OfR1W",songName:"_2b0O4qR1U949NuqZHG0rDW",songCreator:"_2Ekk2V7bfLi-WIEHRrawnv",second:"_3HGrHnDeHpZumNXgIB0ahX",canPlaying:"_3B08xlREDZ2TTBjaHLS8na",backTop:"_2N80j-B5i-D0JuOeH9zKy8"}},287:function(e,a,t){"use strict";t.r(a);var n=t(48),r=t.n(n),c=t(68),i=t(9),l=t(0),s=t.n(l),m=t(288),o=t(209),u=t(284),d=t(285),f=t(290),v=t(291),g=t(7),b=t(110),p=t.n(b),E=t(67),h=t(36);var N=function(e){return-1!==e.st&&-200!==e.st&&1!==e.fee&&4!==e.fee&&16!==e.fee},j=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=e.length,n=[];if(t<=a)return[e];for(var r=0;r<t;r+=a)n.push(e.slice(r,r+a));return n},x=t(57),_=t(11),y=t(273),O=t.n(y),k=t(215),I=t(245),U=t(289),w=function(e){var a;return s.a.createElement("div",{style:{width:"100%",minHeight:"30vh",display:"flex",justifyContent:"center",alignItems:"center"}},s.a.createElement(I.a,{tip:null!==(a=e.text)&&void 0!==a?a:"",indicator:s.a.createElement(U.a,{style:{fontSize:24}})}))},T={info:{albumId:"",name:"",nickname:"",coverImgUrl:"",createTime:0,avatarUrl:"",tags:[],description:""},list:[]};a.default=function(){var e=Object(g.b)(),a=Object(h.d)(),t=Object(l.useState)(!1),n=Object(i.a)(t,2),b=n[0],y=n[1],I=Object(h.b)("cache-song-list",null)[1],U=Object(h.b)(a.query.id,T),L=Object(i.a)(U,2),D=L[0],P=L[1],z=Object(l.useMemo)((function(){return D.list.filter((function(e){return e.url}))}),[D.list]);Object(l.useEffect)((function(){function e(){return(e=Object(c.a)(r.a.mark((function e(){var t,n,c,i,l,s,m,o,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,Object(E.a)(a.query.id);case 3:return t=e.sent,n=t.data.playlist,c={info:{albumId:a.query.id,name:n.name,nickname:n.creator.nickname,avatarUrl:n.creator.avatarUrl,createTime:n.createTime,coverImgUrl:n.coverImgUrl,description:n.description,tags:n.tags},list:[]},i=j(n.trackIds.map((function(e){return e.id}))).map((function(e){return e.join(",")})),e.prev=7,l=i.map((function(e){return Object(E.e)(e)})),e.next=11,Promise.all(l);case 11:return s=e.sent,m=[],o=[],s.forEach((function(e){m=m.concat(e.data.songs),o=o.concat(e.data.privileges)})),c.list=m.map((function(e,a){return{id:e.id,name:e.name,seconds:e.dt/1e3,authors:e.ar.map((function(e){return e.name})).join("\uff0c"),coverImgUrl:e.al.picUrl,canPlaying:N(o[a]),url:null}})),u=c.list.map((function(e){return Object(E.g)(e.id)})),e.next=19,Promise.all(u);case 19:d=e.sent,c.list.map((function(e,a){return e.url=d[a].data.data[0].url})),P(c),I(c.list.filter((function(e){return e.url})));case 23:return e.prev=23,y(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[7,,23,26]])})))).apply(this,arguments)}D&&D.list.length>0||function(){e.apply(this,arguments)}()}),[D,a.query.id,P,I]);var C=Object(l.useCallback)((function(){e(Object(_.g)({data:z})),e(Object(_.c)({id:z[0].id,index:0,autoPlay:!1}))}),[z,e]),W=Object(l.useCallback)((function(){e(Object(_.g)({data:z})),e(Object(_.c)({id:z[0].id,index:0,autoPlay:!0}))}),[z,e]),H=Object(l.useCallback)((function(a){var t=z.findIndex((function(e){return e.id===a}));t<0&&e(Object(_.g)({data:z})),e(Object(_.c)({id:a,index:t,autoPlay:!0}))}),[z,e]);return console.log("album render"),s.a.createElement("div",{className:O.a.album},s.a.createElement("div",{className:O.a.head},s.a.createElement("div",{className:O.a.logo},s.a.createElement("img",{className:O.a.img,src:D.info.coverImgUrl,alt:""})),s.a.createElement("div",{className:O.a.main},s.a.createElement("div",{className:O.a.name},s.a.createElement(m.a,{color:"magenta"},"\u6b4c\u5355"),D.info.name),s.a.createElement("div",{className:O.a.creater},s.a.createElement(k.a,{width:"36px",height:"36px",src:D.info.avatarUrl,border:!0}),s.a.createElement("div",{className:O.a.nickname},D.info.nickname),s.a.createElement("div",{className:O.a.createTime},"\u521b\u5efa\u65f6\u95f4\uff1a",D.info.createTime?p()().format("YYYY-MM-DD"):"NULL")),s.a.createElement("div",{className:O.a.buttonGroup},s.a.createElement(o.a,{size:"small",icon:s.a.createElement(f.a,null),onClick:W},"\u64ad\u653e"),s.a.createElement(o.a,{size:"small",onClick:C},s.a.createElement(v.a,null))),s.a.createElement("div",{className:O.a.tags},"\u6807\u7b7e\uff1a",D.info.tags.map((function(e){return s.a.createElement(m.a,{key:e},e)}))),s.a.createElement("div",{className:O.a.descript},"\u4ecb\u7ecd\uff1a",D.info.description))),s.a.createElement("div",{className:O.a.listBox},s.a.createElement("div",{className:O.a.title},"\u6b4c\u66f2\u5217\u8868"),s.a.createElement("div",{className:O.a.list},b?s.a.createElement(w,{text:"Loading..."}):s.a.createElement(u.b,{bordered:!0,size:"small",dataSource:D.list,renderItem:function(e,a){return s.a.createElement(u.b.Item,{key:e.id},s.a.createElement("div",{className:O.a.item},s.a.createElement("div",{className:O.a.index},a+1),s.a.createElement("div",{className:O.a.song},s.a.createElement(k.a,{border:!0,src:e.coverImgUrl,width:"36px",height:"36px"}),s.a.createElement("div",{className:O.a.songName},e.name)),s.a.createElement("div",{className:O.a.songCreator},e.authors),s.a.createElement("div",{className:O.a.second},s.a.createElement(x.a,{seconds:e.seconds})),s.a.createElement("div",{className:O.a.canPlaying},e.url?s.a.createElement(o.a,{onClick:function(){return H(e.id)},type:"text",size:"small"},"\u64ad\u653e"):s.a.createElement(o.a,{type:"text",size:"small",disabled:!0},"\u65e0\u7248\u6743"))))}}))),s.a.createElement(d.a,{className:O.a.backTop,visibilityHeight:600}))}}}]);
//# sourceMappingURL=7.f43a3ada.chunk.js.map